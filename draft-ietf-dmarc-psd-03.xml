<?xml version="1.0" encoding="US-ASCII"?>

<!DOCTYPE rfc SYSTEM "rfc2629.dtd">
<?xml-stylesheet type='text/xsl' href='rfc2629.xslt' ?>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc compact="yes"?>
<?rfc subcompact="no"?>

<rfc category="exp"
     docName="draft-ietf-dmarc-psd-03"
     ipr="trust200902">

 <front>
   <title abbrev="PSD DMARC">DMARC (Domain-based Message Authentication, 
       Reporting, and Conformance) Extension For PSDs (Public Suffix Domains)
   </title>

   <author initials="S." surname="Kitterman"
	   fullname="Scott Kitterman">
      <organization>fTLD Registry Services</organization>

      <address>
	 <postal>
	    <street>600 13th Street, NW, Suite 400</street>
	    <city>Washington</city>
	    <region>DC</region>
	    <code>20005</code>
	    <country>United States of America</country>
	 </postal>
	    
	 <phone>+1 301 325-5475</phone>
	 <email>scott@kitterman.com</email>
      </address>
   </author>

   <date month="April" year="2019" />

   <keyword>DMARC</keyword>
   <keyword>email authentication</keyword>
   <keyword>TLD</keyword>

   <abstract>
     <t>DMARC (Domain-based Message Authentication, Reporting, and Conformance) 
         is a scalable mechanism by which a mail-originating organization can
         express domain-level policies and preferences for message validation,
         disposition, and reporting, that a mail-receiving organization can use
         to improve mail handling.  DMARC policies can be applied at the
         individual domain level or for a set of domains at the organizational
         level.  The design of DMARC precludes grouping policies for a set of
         domains above the organizational level, such as TLDs (Top Level
         Domains).  These types of domains (which are not all at the top level
         of the DNS tree) can be collectively referred to as Public Suffix
         Domains (PSDs).  For the subset of PSDs that require DMARC usage, this
         memo describes an extension to DMARC to enable DMARC functionality for
         such domains.</t>
   </abstract>
 </front>

 <middle>
   <section anchor="intro" title="Introduction">
     <t><xref target="RFC7489">DMARC</xref> provides a mechanism for publishing
         organizational policy information to email receivers.  <xref
         target="RFC7489">DMARC</xref> allows policy to be specified for both
         individual domains and sets of domains within a single organization.
         For domains above the organizational level in the DNS tree, policy can
         only be published for the exact domain.  There is no method available
         to such domains to express lower level policy or receive feedback
         reporting for sets of domains.  This prevents policy application to
         non-existent domains and identification of domain abuse in email, which
         can be important for brand and consumer protection.
     </t>
     <t>As an example, imagine a country code TLD (ccTLD) which has public
         subdomains for government and commercial use (.gov.example and
         .com.example).  Within the .gov.example public suffix, use of <xref
         target="RFC7489">DMARC</xref> has been mandated and .gov.example has
         published its own <xref target="RFC7489">DMARC</xref> record:
         <figure><artwork>
"v=DMARC1;p=reject;rua=mailto:dmarc@dmarc.service.gov.example"
        </artwork></figure>
         at
         <figure><artwork>
_dmarc.gov.example.
         </artwork></figure>
         This would provide policy and feedback for mail sent from @gov.example,
         but not @tax.gov.example and there is no way to publish an
         organizational level policy that would do so.  While, in theory,
         receivers could reject mail from non-existent domains, not all
         receivers do so.  Non-existence of the sending domain can be a factor
         in a mail delivery decision, but is not generally treated as definitive
         on its own.
     </t>
     <t>This memo provides a simple extension to <xref target="RFC7489">DMARC
         </xref> to allow operators of Public Suffix Domains (PSDs) to express
         policy for groups of subdomains, extends the <xref target="RFC7489">
         DMARC</xref> policy query functionality to detect and process such a
         policy, describes receiver feedback for such policies, and provides
         controls to mitigate potential privacy considerations associated with
         this extension.
     </t>
     <t>There are two types of Public Suffix Operators (PSOs) for which this
         extension would be useful and appropriate:
     </t>
         <t><list style="symbols">
                  <t>Branded PSDs (e.g., ".google"): These domains are
                      effectively Organizational Domains as discussed in <xref
                      target="RFC7489">DMARC</xref>.  They control all
                      subdomains of the tree.  These are effectively private
                      domains, but listed in the Public Suffix List.  They are
                      treated as Public for <xref target="RFC7489">DMARC</xref>
                      purposes.  They require the same protections as <xref
                      target="RFC7489">DMARC</xref> Organizational Domains, but
                      are currently excluded.
                  </t>
                  <t>Multi-organization PSDs that require DMARC usage (e.g.,
                      ".bank"):  Because existing Organizational Domains using
                      this PSD have their own DMARC policy, the applicability of
                      this extension is for non-existent domains.  The extension
                      allows the brand protection benefits of <xref
                      target="RFC7489">DMARC</xref> to extend to the entire PSD,
                      including cousin domains of registered organizations.
                  </t>
          </list></t>
     <t>Due to the design of <xref target="RFC7489">DMARC</xref> and the nature
         of the Internet <xref target="RFC5598">email architecture</xref>, there
         are interoperability issues associated with <xref target="RFC7489">
         DMARC</xref> deployment.  These are discussed in <xref target="RFC7960">
         Interoperability Issues between DMARC and Indirect Email Flows</xref>.
         These issues are not applicable to PSDs, since they (e.g., the
         ".gov.example" used above) do not send mail.
     </t>
     <t><xref target="RFC7489">DMARC</xref>, by design, does not support
         usage by PSOs.  For PSDs that require use of <xref
	 target="RFC7489">DMARC</xref>, an extension of DMARC reporting and
	 enforcement capability is needed for PSO to effectively manage and
	 monitor implementation of PSD requirements.
     </t>

   </section>

   <section title="Terminology and Definitions">
       <t>This section defines terms used in the rest of the document.
       </t>
       <section title="Conventions Used in This Document">
           <t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
               NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
               "MAY", and "OPTIONAL" in this document are to be interpreted as
               described in BCP&nbsp;14 <xref target="RFC2119"/>
               <xref target="RFC8174"/>  when, and only when, they appear in all
               capitals, as shown here.
           </t>
       </section>
       <section title="Public Suffix Domain (PSD)">
           <t>The global Internet Domain Name System (DNS) is documented in
               numerous Requests for Comment (RFC).  It defines a tree of names
               starting with root, ".", immediately below which are Top Level
               Domain names such as ".com" and ".us".  They are not available
               for private registration.  In many cases the public portion of
               the DNS tree is more than one level deep.  PSD DMARC includes all
               public domains above the organizational level in the tree, e.g.,
               ".gov.uk".
           </t>
       </section>
       <section anchor="lpsd" title="Longest PSD">
           <t>Organizational Domain (<xref target="RFC7489">DMARC</xref> Section
               3.2) with one label removed.
           </t>
       </section>
       <section title="Public Suffix Operator (PSO)">
           <t>A Public Suffix Operator manages operations within their PSD.
           </t>
       </section>
       <section title="PSO Controlled Domain Names">
           <t>PSO Controlled Domain Names are names in the DNS that are
               managed by a PSO and are not available for use as Organizational
               Domains (the term Organizational Domains is defined in <xref
               target="RFC7489">DMARC</xref> Section 3.2).  Depending on PSD policy, these
               will have one (e.g., ".com") or more (e.g., ".co.uk") name
               components.
           </t>
       </section>
       <section title="Non-existent Domains">
           <t>For <xref target="RFC7489">DMARC</xref> purposes, a non-existent
               domain is a domain name that publishes none of A, AAAA, or MX
               records that the receiver is willing to accept.  This is a
               broader definition than that in <xref
               target="RFC8020">NXDOMAIN</xref>.
           </t>
       </section>
   </section>

   <section title="PSD DMARC Updates to DMARC Requirements">

     <t>This document updates <xref target="RFC7489">DMARC</xref> as follows:</t>

     <section title="General Updates">
         <t>References to "Domain Owners" also apply to PSOs.</t>
     </section>
     <section title="Section 6.1 DMARC Policy Record">
         <t>PSD DMARC records are published as a subdomain of the PSD.  For the
             PSD ".example", the PSO would post DMARC policy in a TXT
             record at "_dmarc.example".
         </t>
     </section>
     <section title="Section 6.5.  Domain Owner Actions">
         <t>In addition to the <xref target="RFC7489">DMARC</xref> domain owner
             actions, PSOs that require use of DMARC ought to make that
	     information available to receivers.
         </t>
     </section>
     <section title="Section 6.6.3.  Policy Discovery">
         <t>A new step between step 3 and 4 is added:</t>
         <t><list style="hanging">
               <t hangText="3A.">If the set is now empty and the <xref
                   target="lpsd">longest PSD</xref> of the  Organizational
                   Domain is one that the receiver has determined is acceptable
		   for PSD DMARC, the Mail Receiver MUST query the DNS for a
                   DMARC TXT record at the DNS domain matching the <xref
                   target="lpsd">longest PSD</xref> in place of the RFC5322.From
                   domain in the message (if different).  A possibly empty set
                   of records is returned.
               </t>
         </list> </t>
         <t>As an example, for a message with the Organizational Domain of
             "example.compute.cloudcompany.com.cctld", the query for PSD DMARC
             would use "compute.cloudcompany.com.cctld" as the <xref
             target="lpsd">longest PSD</xref>.  The receiver would check to see
             if that PSD is listed in the DMARC PSD Registry, and if so, perform
             the policy lookup at "_dmarc.compute.cloudcompany.com.cctld".
         </t>
         <t>Note: Because the PSD policy query comes after the Organizational
             Domain policy query, PSD policy is not used for Organizational
             domains that have published a <xref target="RFC7489">DMARC</xref>
             policy.  Specifically, this is not a mechanism to provide
             feedback addresses (RUA/RUF) when an Organizational Domain has
             declined to do so.
         </t>
     </section>
     <section title="Section 7.  DMARC Feedback">
         <t> <xref target="RFC7489"/> Section 7.3 Failure Reports MUST NOT be
              sent for PSD DMARC.<t/>
         <t>Operational note for PSD DMARC: For PSOs, feedback for non-existent
             domains is desired and useful.  See <xref target="privacy"/> for
	     discussion of Privacy Considerations.
         </t>
     </section>
   </section>

   <section anchor="privacy" title="Privacy Considerations">
      <t>These privacy considerations are developed based on the requiremetns of
          <xref target="RFC6973"/>.  The Privacy Considerations of <xref
          target="RFC7489"/> apply to this document.
      </t>
      <section anchor="leakage" title="Feedback leakage">
          <t>Providing feedback reporting to PSOs can, in some cases, create
              leakage of information outside of an organization to the PSO.
	      This leakage could be potentially be utilized as part of a program
	      of pervasive surveillance (See <xref target="RFC7624"/>).  There
	      are roughly three cases to consider:
          </t>
          <t><list style="symbols">
                  <t>Single Organization PSDs (e.g., ".google"), RUA and RUF
		      reports based on PSD DMARC have the potential to contain
		      information about emails related to entities managed by
		      the organization.  Since both the PSO and the
                      Organizational Domain owners are common, there is no
                      additional privacy risk for either normal or non-existent
		      Domain reporting due to PSD DMARC.
                  </t>
                  <t>Multi-organization PSDs that require DMARC usage (e.g.,
                      ".bank"):  PSD DMARC based reports will only be generated
                      for domains that do not publish a DMARC policy at the
                      organizational or host level.  For domains that do publish
                      the required DMARC policy records, the feedback reporting
                      addresses (RUA and RUF) of the organization (or hosts)
                      will be used.  The only direct feedback leakage risk for
		      these PSDs are for Organizational Domains that are out of
		      compliance with PSD policy.  Data on non-existent cousin
		      domains would be sent to the PSO.
                  </t>
                  <t>Multi-organization PSDs (e.g., ".com") that do not mandate
                      DMARC usage:  Privacy risks for Organizational Domains
                      that have not deployed DMARC within such PSDs are
		      significant.  For non-DMARC Organizational Domains, all
		      DMARC feedback will be directed to the PSO.  PSD DMARC is
		      opt-out (by publishing a DMARC record at the
		      Organizational Domain level) vice opt-in, which would be
		      the more desirable characteristic.  This means that any
		      non-DMARC organizational domain would have it's feedback
		      reports redirected to the PSO.  The content of such
		      reports, particularly for existing domains, is privacy
		      sensitive.
                  </t>
          </list></t>
          <t>PSOs will receive feedback on non-existent domains, which may be
              similar to existing Organizational Domains.  Feedback related to
              such cousin domains have a small risk of carrying information
              related to an actual Organizational Domain.  To minimize this
              potential concern, PSD DMARC feedback is best limited to
              Aggregate Reports.  Feedback Reports carry more detailed
              information and present a greater risk.
          </t>
	  <t>Due to the inherent Privacy and Security risks associated with
	      PSD DMARC for Organizational Domains in multi-organization PSDs
	      that do not particpate in DMARC, any Feedback Reporting related to
	      multi-organizational PSDs ought to be limited to non-existent
	      domains except in cases where the reporter knows that PSO
	      requires use of DMARC.
	  </t>
      </section>
   </section>

   <section title="Security Considerations">
      <t> This document does not change the Security Considerations of
          <xref target="RFC7489"/> and <xref target="RFC7960"/>.
      </t>
      <t> The risks of the issues identified in <xref target="RFC7489"/>,
	  Section 12.5, External Reporting Addresses, are amplified by PSD
	  DMARC.  By design, PSD DMARC causes unrequested reporting of feedback
	  to entities external to the Organizational Domain.  This is discussed
	  in more detail in <xref target="privacy"/>.
      </t>
   </section>

   <section anchor="iana" title="IANA Considerations">
       <t>This document does not require any IANA actions.</t>
   </section>
 </middle>

 <back>
   <references title="Normative References">
      <?rfc include="reference.RFC.2119" ?>
      <?rfc include="reference.RFC.7489" ?>
      <?rfc include="reference.RFC.8174" ?>
   </references>

   <references title="Informative References">
      <?rfc include="reference.RFC.5226" ?>
      <?rfc include="reference.RFC.5598" ?>
      <?rfc include="reference.RFC.6973" ?>
      <?rfc include="reference.RFC.7624" ?>
      <?rfc include="reference.RFC.7960" ?>
      <?rfc include="reference.RFC.8020" ?>
      <reference anchor="PSL" target="https://publicsuffix.org/">
         <front>
            <title>Public Suffix List</title>
            <author>
               <organization>multiple</organization>
            </author>
            <date month="April" year="2019" />
         </front>
      </reference>
      <reference anchor="psddmarc.org" target="https://psddmarc.org/">
         <front>
            <title>PSD DMARC Web Site</title>
            <author>
               <organization>multiple</organization>
            </author>
            <date month="April" year="2019" />
         </front>
      </reference>

   </references>

   <section anchor="experiment" title="The Experiment">
      <t> To mitigate the privacy concerns associated with Multi-organization
	  PSDs that do not mandate DMARC usage, see <xref target="leakage"/>,
	  a mechanism to indicate which PSDs do not present this privacy risk is
	  appropriate.  There are multiple approaches that are possible.
      </t>
      <t> The experiment is to evaluate different possible approaches.  The
	  experiment will be complete when there is rough consensus on a
	  technical approach that is demonstrated to be operationally usable and
	  effective at mitigating the privacy concern.
      </t>
      <t> The mechanism needs the following attributes: </t>
	  <t><list style="symbols">
		  <t> Be reliably, publicly accessible</t>
		  <t> Be under configuration control based on a public set of
		      criteria
		  </t>
		  <t> List PSDs that either mandate DMARC for their registrants
		      or for which all lower level domains are controlled by the
		      PSO and that the relevant PSO has indicated a desire for
		      the PSD to participate in PSD DMARC
		  </t>
		  <t> Have a small operational footprint (e.g. provide a
		      documented, lightweight mechanism for developers and
		      operators to retrieve the list of PSD DMARC participants)
		  </t>
		  <t> Not allow PSO to add PSDs to the PSD DMARC participants
		      list without third party review
		  </t>
	  </list></t>
      <t> As of this writing, three approaches have been proposed.  None of them
	  are ideal:
      </t>
	  <t><list style="symbols">
		  <t> An IANA registry</t>
		  <t> An extension to the Public Suffix List at <xref
		      target="PSL"/>
		  </t>
		  <t> A dedicated registry queried via DNS - an example of such
		      a service is described in <xref target="registry"/> below
		  </t>
	  </list></t>
    </section>
   <section anchor="registry" title="DMARC PSD Registry Example">
      <t> To faciliate experimentation around data leakage mitigation, a sample
	  service is available at <xref target="psddmarc.org"/>.  It was
	  developed based on the requirements suggested for an IANA registry in
	  an earlier revision of this draft.  Usage of the service is described
	  on the web site.
      </t>
       <section anchor="iana1" title="DMARC Public Suffix Domain (PSD) Registry">
           <t><xref target="psddmarc.org"/> provides a DMARC Public Suffix
	       Domain (PSD) Registry as a stand-alone DNS query service.
           </t>
           <t>Names of PSDs participating in PSD DMARC must be registered this
	       new registry.  New entries are assigned only for PSDs that
	       require use of DMARC.  The requirement has to be documented in a
	       manner that satisfies the terms of Expert Review,per <xref
	       target="RFC5226"/>.  The Designated Expert needs to confirm that
	       provided documentation adequately describes PSD policy to require
	       domain owners to use DMARC or that all domain owners are part of
	       a single organization with the PSO.
           </t>
           <t>The initial set of entries in this registry is as follows:
            <figure><artwork>
+-------------+---------------+
|    PSD      | Status        |
+-------------+---------------+
| .bank       | current       |
+-------------+---------------+
| .insurance  | current       |
+-------------+---------------+
| .gov.uk     | current       |
+-------------+---------------+
                                </artwork> </figure>
           </t>
       </section>
    </section>
   <section anchor="thanks" title="Acknowledgements" numbered="no">
      <t> Thanks to the following individuals for their contributions (both
	  public and private) to improving this document.  Special shout out to
	  Dave Crocker for naming the beast.</t>
      <t> Kurt Andersen, Seth Blank, Dave Crocker, Heather Diaz, Tim Draegen,
	  Zeke Hendrickson, Andrew Kennedy, John Levine, Dr Ian Levy, Craig
	  Schwartz, Alessandro Vesely, and Tim Wicinski</t>
    </section>
 </back>
</rfc>
